<div class="container w-full flex justify-center pt-7">


    <div class="bg-zinc-300 w-3/5 mt-5 rounded-3xl pt-5">
        <h1 class="text-2xl text-center">Création du contrat</h1>
        <mat-stepper class="bg-zinc-100 m-5 p-5 rounded-3xl" #stepper linear="true">
            <mat-step [stepControl]="companyForm">
                <form [formGroup]="companyForm">
                    <ng-template matStepLabel>Information sur l'entreprise</ng-template>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="Raison Social" type="text" formControlName="companyName">
                        </mat-form-field>
                    </div>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <mat-select placeholder="Forme juridique" formControlName="legalForm">
                                <mat-option value="SASU">SASU</mat-option>
                                <mat-option value="SAS">SAS</mat-option>
                                <mat-option value="EURL">EURL</mat-option>
                                <mat-option value="SARL">SARL</mat-option>
                                <mat-option value="SCI">SCI</mat-option>
                                <mat-option value="SNC">SNC</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="SIRET" type="number" formControlName="siret">
                        </mat-form-field>
                    </div>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="SIREN" type="number" formControlName="siren">
                        </mat-form-field>
                    </div>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="Activité de l'entreprise" type="text"
                                formControlName="businessActivity">
                        </mat-form-field>
                    </div>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="Adresse de l'entreprise" type="text"
                                formControlName="businessAddress">
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field class="w-2/3">
                            <mat-select placeholder="Mois de clôture de l'exercice" formControlName="closingMonth">
                                <mat-option value="1">Janvier</mat-option>
                                <mat-option value="2">février</mat-option>
                                <mat-option value="3">mars</mat-option>
                                <mat-option value="4">Avril</mat-option>
                                <mat-option value="5">Mai</mat-option>
                                <mat-option value="6">Juin</mat-option>
                                <mat-option value="7">juillet</mat-option>
                                <mat-option value="8">août</mat-option>
                                <mat-option value="9">septembre</mat-option>
                                <mat-option value="10">octobre</mat-option>
                                <mat-option value="11">novembre</mat-option>
                                <mat-option value="12">décembre</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="Effectif" type="number" formControlName="workforce">
                        </mat-form-field>
                    </div>
                    <div class="mt-2">
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="Masse salariale" type="number" formControlName="totalWages">
                        </mat-form-field>
                    </div>

                    <div>
                        <button mat-raised-button color="primary" matStepperNext>Suivant</button>
                    </div>

                </form>

            </mat-step>

            <mat-step [stepControl]="companySignatoryForm">
                <form [formGroup]="companySignatoryForm">
                    <ng-template matStepLabel>Identité du signataire</ng-template>
                    <div class="flex">
                        <div class="w-1/2">
                            <mat-form-field class="w-2/3">
                                <input matInput placeholder="Nom" type="text" formControlName="lastName">
                            </mat-form-field>
                        </div>
                        <div class="w-1/2">
                            <mat-form-field class="w-2/3">
                                <input matInput placeholder="Prénom" type="text" formControlName="firstName">
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="flex">
                        <div class="w-1/2">
                            <mat-form-field class="w-2/3">
                                <input matInput placeholder="Email" type="email" formControlName="email">
                            </mat-form-field>
                        </div>
                        <div class="w-1/2">
                            <mat-form-field class="w-2/3">
                                <input matInput placeholder="Téléphone" type="number" formControlName="phone">
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="flex">
                        <div class="w-1/2">
                            <mat-form-field class="w-2/3">
                                <input matInput [matDatepicker]="picker2" placeholder="Date de naissance"
                                    formControlName="dateOfBirth">
                                <mat-datepicker-toggle matIconSuffix [for]="picker2"></mat-datepicker-toggle>
                                <mat-datepicker #picker2></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="w-1/2">
                            <mat-form-field class="w-2/3">
                                <input matInput placeholder="Fonction" type="text" formControlName="jobTitle">
                            </mat-form-field>

                        </div>
                    </div>

                    <div>
                        <mat-form-field class="w-2/3">
                            <input matInput placeholder="Numéro de sécurité social" type="number"
                                formControlName="socialSecurityNumber">
                        </mat-form-field>
                    </div>

                    <div class="flex">
                        <div class="w-1/2">
                            <mat-select-country label="Pays de naissance" placeHolder="Pays de naissance"
                                formControlName="countryOfBirth" itemsLoadSize="4" value="">
                            </mat-select-country>
                        </div>
                        <div class="w-1/2">
                            <mat-select-country label="Pays de résidence" placeHolder="Pays de résidence"
                                formControlName="countryOfResidence" itemsLoadSize="4">
                            </mat-select-country>
                        </div>
                    </div>

                    <div class="mt-2">
                        <mat-radio-group aria-label="Select an option" formControlName="executive">
                            <label for="">Le signataire est-il dirigeant? </label>
                            <mat-radio-button value="true">oui</mat-radio-button>
                            <mat-radio-button value="false">non</mat-radio-button>
                        </mat-radio-group>
                    </div>

                    <div class="mt-2">
                        <mat-radio-group aria-label="Select an option" formControlName="eligibility">
                            <label for="">Éligibilité au dispositif par ancienneté? </label>
                            <mat-radio-button value="1">1 moi</mat-radio-button>
                            <mat-radio-button value="2">2 mois</mat-radio-button>
                            <mat-radio-button value="3">3 mois</mat-radio-button>
                        </mat-radio-group>
                    </div>

                    <div class="flex mt-2">
                        <div class="w-1/3 pt-2">
                            <mat-label for="">Plans à mettre en place</mat-label>
                        </div>

                        <div class="w-2/3">
                            <mat-checkbox class="example-margin" name="df"
                                (change)="onPeeCheckedChange($event)">PEE</mat-checkbox>
                            <mat-checkbox class="example-margin" (change)="onPercoCheckedChange($event)"
                                name="rd">PERCO</mat-checkbox>
                        </div>
                    </div>

                    <div>
                        <button mat-raised-button color="primary mr-5" matStepperPrevious>précédent</button>
                        <button mat-raised-button color="primary" matStepperNext
                            [disabled]="noPlanSelected()">Suivant</button>
                    </div>


                </form>
            </mat-step>

            <mat-step label="Configuration des plans">
                <form [formGroup]="peeContributionForm">

                    <!-- PEE plan -->
                    <div *ngIf="peeChecked">
                        <div class="text-center">
                            <h2 class="text-2xl">PEE</h2>
                        </div>

                        <div class="flex mt-2">
                            <div class="w-1/3 pt-2">
                                <mat-label for="">Abondement</mat-label>
                            </div>

                            <div class="w-2/3">
                                <mat-checkbox class="example-margin" formControlName="peeInterestAccepted">sur sur
                                    l'intéressement</mat-checkbox>
                                <mat-checkbox class="example-margin" formControlName="peeVoluntaryDepositAccepted">sur
                                    les versements volontaires</mat-checkbox>
                                <mat-checkbox class="example-margin" formControlName="peeProfitSharingAccepted">sur la
                                    participation</mat-checkbox>
                            </div>
                        </div>

                        <div class="w-1/2 mt-2">
                            <mat-form-field class="w-2/3">

                                <mat-select placeholder="Type d'abondement"
                                    (selectionChange)="onAbondementPeeTypeChange($event)">
                                    <mat-option value="sm">Simple</mat-option>
                                    <mat-option value="pl">Par paliers</mat-option>
                                    <mat-option value="an">Par ancienneté</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div *ngIf="selectedAbondementTypePEE == 'sm'">
                            <div class="text-center my-2">
                                <h2 class="text-lg">Simple</h2>
                            </div>
                            <div class="flex">
                                <div class="w-1/2">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux" formControlName="rateSimpleContribution">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/2">
                                    <mat-form-field class="w-2/3">
                                        <input matInput placeholder="Plafond" type="number"
                                            formControlName="ceilingSimpleContribution">
                                    </mat-form-field>

                                </div>
                            </div>

                        </div>


                        <div *ngIf="selectedAbondementTypePEE == 'pl'">
                            <div class="text-center my-3">
                                <h2 class="text-lg">Par paliers</h2>
                            </div>

                            <div class="flex">
                                <div class="w-2/4 mr-2">

                                    <mat-form-field class="w-1/2 pr-2">
                                        <input matInput placeholder="De" type="number">€
                                    </mat-form-field>
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="A" type="number"
                                            formArrayName="intervalContributionFirst">€
                                    </mat-form-field>
                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux" formControlName="rateIntervalContributionFirst">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="Plafond" type="number"
                                            formControlName="ceilingIntervalContributionFirst">
                                    </mat-form-field>

                                </div>
                            </div>
                            <div class="flex">
                                <div class="w-2/4 mr-2">

                                    <mat-form-field class="w-1/2 pr-2">
                                        <input matInput placeholder="De" type="number">€
                                    </mat-form-field>
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="A" type="number"
                                            formArrayName="intervalContributionSecond">€
                                    </mat-form-field>
                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="Plafond" type="number">
                                    </mat-form-field>

                                </div>
                            </div>
                            <div class="flex">
                                <div class="w-2/4 mr-2">

                                    <mat-form-field class="w-1/2 pr-2">
                                        <input matInput placeholder="De" type="number">€
                                    </mat-form-field>
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="A" type="number"
                                            formControlName="intervalContributionThird">€
                                    </mat-form-field>
                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux" formControlName="rateIntervalContributionThird">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="Plafond" type="number"
                                            formControlName="ceilingIntervalContributionThird">
                                    </mat-form-field>

                                </div>
                            </div>
                        </div>

                        <div *ngIf="selectedAbondementTypePEE == 'an'">
                            <div class="text-center my-3">
                                <h2 class="text-lg">Par ancienneté</h2>
                            </div>
                            <div class="">
                                <mat-form-field class="w-1/4">
                                    <mat-select placeholder="Taux" formControlName="rateSeniorityContribution">
                                        <mat-option value="50">50%</mat-option>
                                        <mat-option value="100">100%</mat-option>
                                        <mat-option value="150">150%</mat-option>
                                        <mat-option value="200">200%</mat-option>
                                        <mat-option value="250">250%</mat-option>
                                        <mat-option value="300">300%</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="flex">
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="< 1 an" type="number"
                                        formControlName="ceilingSeniorityContributionLessYear">
                                </mat-form-field>
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="1 à 3 ans" type="number"
                                        formControlName="ceilingSeniorityContributionBetween1And3">
                                </mat-form-field>
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="3 à 5 ans" type="number"
                                        formControlName="ceilingSeniorityContributionBetween3And5">
                                </mat-form-field>
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="> 5 ans" type="number"
                                        formControlName="ceilingSeniorityContributionGreater5">
                                </mat-form-field>

                            </div>
                        </div>

                    </div>
                    <!-- end of PEE plan -->
                </form>

                <form [formGroup]="perecoContributionForm">
                    <!-- PERCO plan -->
                    <div *ngIf="percoChecked">
                        <mat-divider></mat-divider>
                        <div class="text-center mt-3">
                            <h2 class="text-2xl">PERCO</h2>
                        </div>

                        <div class="flex mt-2">
                            <div class="w-1/3 pt-2">
                                <mat-label for="">Abondement</mat-label>
                            </div>

                            <div class="w-2/3">
                                <mat-checkbox class="example-margin" formControlName="perecoInterestAccepted">sur sur
                                    l'intéressement</mat-checkbox>
                                <mat-checkbox class="example-margin"
                                    formControlName="perecoVoluntaryDepositAccepted">sur
                                    les versements volontaires</mat-checkbox>
                                <mat-checkbox class="example-margin" formControlName="perecoProfitSharingAccepted">sur
                                    la
                                    participation</mat-checkbox>
                                <mat-checkbox class="example-margin"
                                    formControlName="perecoTimeSavingAccountAccepted">Compte épargne
                                    temps</mat-checkbox>
                            </div>
                        </div>

                        <div class="w-1/2 mt-2">
                            <mat-form-field class="w-2/3">
                                <mat-select placeholder="Type d'abondement"
                                    (selectionChange)="onAbondementPercoTypeChange($event)">
                                    <mat-option value="sm">Simple</mat-option>
                                    <mat-option value="pl">Par paliers</mat-option>
                                    <mat-option value="an">Par ancienneté</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div *ngIf="selectedAbondementTypePERCO == 'sm'">
                            <div class="text-center my-2">
                                <h2 class="text-lg">Simple</h2>
                            </div>
                            <div class="flex">
                                <div class="w-1/2">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux" formControlName="rateIntervalContributionFirst">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/2">
                                    <mat-form-field class="w-2/3">
                                        <input matInput placeholder="Plafond" type="number"
                                            formControlName="ceilingIntervalContributionFirst">
                                    </mat-form-field>

                                </div>
                            </div>

                        </div>


                        <div *ngIf="selectedAbondementTypePERCO == 'pl'">
                            <div class="text-center my-3">
                                <h2 class="text-lg">Par paliers</h2>
                            </div>

                            <div class="flex">
                                <div class="w-2/4 mr-2">

                                    <mat-form-field class="w-1/2 pr-2">
                                        <input matInput placeholder="De" type="number">€
                                    </mat-form-field>
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="A" type="number"
                                            formControlName="intervalContributionFirst">€
                                    </mat-form-field>
                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux" formControlName="rateIntervalContributionSecond">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="Plafond" type="number"
                                            formControlName="ceilingIntervalContributionSecond">
                                    </mat-form-field>

                                </div>
                            </div>
                            <div class="flex">
                                <div class="w-2/4 mr-2">

                                    <mat-form-field class="w-1/2 pr-2">
                                        <input matInput placeholder="De" type="number">€
                                    </mat-form-field>
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="A" type="number"
                                            formControlName="intervalContributionSecond">€
                                    </mat-form-field>
                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux" formControlName="rateIntervalContributionThird">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="Plafond" type="number"
                                            formControlName="ceilingIntervalContributionThird">
                                    </mat-form-field>

                                </div>
                            </div>
                            <div class="flex">
                                <div class="w-2/4 mr-2">

                                    <mat-form-field class="w-1/2 pr-2">
                                        <input matInput placeholder="De" type="number">€
                                    </mat-form-field>
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="A" type="number"
                                            formControlName="intervalContributionThird">€
                                    </mat-form-field>
                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-2/3">
                                        <mat-select placeholder="Taux">
                                            <mat-option value="50">50%</mat-option>
                                            <mat-option value="100">100%</mat-option>
                                            <mat-option value="150">150%</mat-option>
                                            <mat-option value="200">200%</mat-option>
                                            <mat-option value="250">250%</mat-option>
                                            <mat-option value="300">300%</mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </div>
                                <div class="w-1/4">
                                    <mat-form-field class="w-1/2">
                                        <input matInput placeholder="Plafond" type="number">
                                    </mat-form-field>

                                </div>
                            </div>
                        </div>

                        <div *ngIf="selectedAbondementTypePERCO == 'an'">
                            <div class="text-center my-3">
                                <h2 class="text-lg">Par ancienneté</h2>
                            </div>
                            <div class="">
                                <mat-form-field class="w-1/4">
                                    <mat-select placeholder="Taux" formControlName="rateSeniorityContribution">
                                        <mat-option value="50">50%</mat-option>
                                        <mat-option value="100">100%</mat-option>
                                        <mat-option value="150">150%</mat-option>
                                        <mat-option value="200">200%</mat-option>
                                        <mat-option value="250">250%</mat-option>
                                        <mat-option value="300">300%</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="flex">
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="< 1 an" type="number"
                                        formControlName="ceilingSeniorityContributionLessYear">
                                </mat-form-field>
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="1 à 3 ans" type="number"
                                        formControlName="ceilingSeniorityContributionBetween1And3">
                                </mat-form-field>
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="3 à 5 ans" type="number"
                                        formControlName="ceilingSeniorityContributionBetween3And5">
                                </mat-form-field>
                                <mat-form-field class="w-1/4 pr-2">
                                    <input matInput placeholder="> 5 ans" type="number"
                                        formControlName="ceilingSeniorityContributionGreater5">
                                </mat-form-field>

                            </div>
                        </div>

                    </div>
                    <!-- end of PERCO plan -->
                </form>

                <div>
                    <button mat-raised-button color="primary mr-5" matStepperPrevious>précédent</button>
                    <button mat-raised-button color="primary" (click)="onSubmit()">Valider</button>
                </div>
            </mat-step>
        </mat-stepper>

    </div>
</div>